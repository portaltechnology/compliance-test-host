<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Disable inactive accounts automation</title>
<meta name="description" content="The following guide provides instructions to automate disabling and suspending inactive accounts for cloud-native implementation types. The following is guidance from the Australian Cyber Security Centre (ACSC) for inactive accounts: Access to systems, applications and data repositories is removed or...">
<link rel="stylesheet" href="/assets/css/styles.css">
<link rel="canonical" href="/blueprint/abac/admin-disable-inactive-users.html">
<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="194x194" href="/assets/images/favicons/favicon-194x194.png">
<link rel="icon" type="image/png" sizes="192x192" href="/assets/images/favicons/android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicons/favicon-16x16.png">
<meta property="og:image" content="https://desktop.gov.au/assets/images/dta-opengraph.png"/>
<meta property="og:title" content="Disable inactive accounts automation">
<meta property="og:description" content="The following guide provides instructions to automate disabling and suspending inactive accounts for cloud-native implementation types. The following is guidance from the Australian Cyber Security Centre (ACSC) for inactive accounts: Access to systems, applications and data repositories is removed or...">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="628">
</head>
<body class="au-grid" data-spy="scroll" data-target="#toc-container">
<nav class="au-skip-link">
    <a class="au-skip-link__link" href="#content">Skip to main content</a>
    <a class="au-skip-link__link" href="#mainmenu">Skip to main navigation</a>
</nav>

<header class="au-header au-header--dark" role="banner">
    <div class="container">
        <div class="row">
            <div class="logo col-md-8">
                <a href="/">
                    <img class="hidden-print" alt="Australian Government Digital Transformation Agency logo" src="/assets/images/dta.svg" data-fallback="/assets/images/dta-300.png">
                    <h1><Company Name> - <Security Controls, ie Essential 8, Maturity 1></h1>
                </a>
            </div>
        </div>
    </div>
    <nav class="au-main-nav au-main-nav--dark hidden-print" aria-label="main">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div id="main-nav-default" class="au-main-nav__content">
                    <button
                        aria-controls="main-nav-default"
                        class="au-main-nav__toggle au-main-nav__toggle--open"
                        onClick="return AU.mainNav.Toggle( this )">
                        Menu
                    </button>
                    <div class="au-main-nav__menu">
                        <div class="au-main-nav__menu-inner">
                            <div class="au-main-nav__focus-trap-top"></div>
                            <button
                                aria-controls="main-nav-default"
                                class="au-main-nav__toggle au-main-nav__toggle--close"
                                onClick="return AU.mainNav.Toggle( this )">
                                Close
                            </button>
                            <ul class="au-link-list">
                                <li><a href="/">Home</a></li>
                                <li class=""><a href="/blueprint/index.html">Blueprint</a></li>
                                
                            </ul>
                            <div class="au-main-nav__focus-trap-bottom"></div>
                        </div>
                    </div>
                    <div
                        class="au-main-nav__overlay"
                        aria-controls="main-nav-default"
                        onClick="return AU.mainNav.Toggle( this )">
                    </div>
                </div>
            </div>
        </div>
    </div>
</nav>

</header>

<main class="main" id="content" aria-label="Content">
    <section class="au-body">
        <div class="container">
            <div class="row mt-2">
                <div class="col-12 d-flex">
                    <div id="lhs" class="hidden-print">
                        <aside class="au-side-nav au-accordion" aria-label="side navigation">
                            <button 
                                class="au-side-nav__toggle au-accordion__title au-accordion--closed" 
                                aria-controls="sidebar-nav-container"
                                aria-expanded="false"  
                                onclick="return AU.accordion.Toggle( this )"
                            >
                                In this section
                            </button>
                            <div id="sidebar-nav-container" class="au-side-nav__content au-accordion--closed au-accordion__body">
                                
                                    
                                    <ul class="au-link-list">
                                        <li class="sidenav-title "><a href="/blueprint/abac.html">As Built As Configured</a>
                                            
                                        </li>
                                        
                                        <li><a href="/blueprint/abac/conditional-access-policies.html">Conditional access policies</a>
                                            
                                        </li>
                                        
                                        <li><a href="/blueprint/abac/intune-applications.html">Intune applications</a>
                                            
                                        </li>
                                        
                                        <li><a href="/blueprint/abac/intune-compliance.html">Intune compliance</a>
                                            
                                        </li>
                                        
                                        <li><a href="/blueprint/abac/intune-configuration.html">Intune configuration</a>
                                            
                                        </li>
                                        
                                        <li><a href="/blueprint/abac/intune-enrolment.html">Intune enrolment</a>
                                            
                                        </li>
                                        
                                        <li><a href="/blueprint/abac/intune-software-updates.html">Intune software updates</a>
                                            
                                        </li>
                                        
                                        <li><a href="/blueprint/abac/office-365.html">Office 365</a>
                                            
                                        </li>
                                        
                                        <li><a href="/blueprint/abac/platform.html">Platform</a>
                                            
                                        </li>
                                        
                                        <li><a href="/blueprint/abac/hybrid-task-sequence.html">Hybrid - task sequence deploy</a>
                                            
                                        </li>
                                        
                                        <li><a href="/blueprint/abac/hybrid-network-configuration.html">Hybrid - network configuration</a>
                                            
                                        </li>
                                        
                                        <li class="active"><a href="/blueprint/abac/admin-disable-inactive-users.html">Administration - disable inactive accounts automation</a>
                                            
                                            <nav class="navbar" id="toc-container">
                                                <ul class="nav au-link-list"><li><a href="#microsoft-graph-api">Microsoft Graph API</a></li><li><a href="#sample-automation-script">Sample automation script</a></li></ul>
                                            </nav>
                                            
                                        </li>
                                        
                                        <li><a href="/blueprint/abac/wdac-policy-creation.html">WDAC policy creation</a>
                                            
                                        </li>
                                        
                                        <li><a href="/blueprint/abac/wfw-rules-import.html">Windows Firewall rules import</a>
                                            
                                        </li>
                                        
                                        
                                    </ul>
                                    
                                
                            </div>
                        </aside>
                    </div>
                    <div id="content-area">
                        <h1>Disable inactive accounts automation</h1>
                        <div class="metadata">
                            <ul>
                                <li>


9 minutes

to read</li>
                                <li>17 July 2023</li>
                                
                            </ul>
                        </div>
                        <p>The following guide provides instructions to automate disabling and suspending inactive accounts for cloud-native implementation types.</p>

<p>The following is guidance from the Australian Cyber Security Centre (ACSC) for inactive accounts:</p>

<ul>
  <li>Access to systems, applications and data repositories is removed or suspended after 45 days of inactivity (<strong>ISM</strong> security controls 1404 and 1648).</li>
  <li>Privileged access to systems and applications is automatically disabled after 45 days of inactivity (<strong>Essential Eight</strong>).</li>
</ul>

<p>Azure Active Directory (Azure AD) does not include the ability to disable inactive accounts automatically, however, automation can be implemented to provide this administrative function.</p>

<p>With hybrid implementation types, access is managed through Active Directory Domain Services (AD DS) management tools and Active Directory mirrors changes to Azure AD. This may also include third-party tooling for automation.</p>

<p>This guide includes a sample script that uses the Microsoft Graph API and Azure AD PowerShell modules. The Microsoft Graph API is used to query the sign-in activity within the tenant as it is the only method to reliably ascertain the last interactive sign-in from Azure AD sign-in logs.</p>

<p>The script can be executed manually by an administrator or automatically on a schedule. If the agency has an Azure subscription, it can be scheduled from within an Azure Automation account.</p>

<p>For simplicity, the script disables all accounts after 30 days of inactivity, excluding break glass accounts or those that are yet to sign in.</p>

<p>Agencies can tweak the script to better reflect their needs.</p>

<p>The script is provided as a sample and without warranty, limited error checking or handling provided.</p>

<h2 id="microsoft-graph-api">Microsoft Graph API</h2>

<p>In order to use the Graph API to query sign-in information, the agency must create an Azure AD App registration which will be used by the script to authenticate to the Graph API.</p>

<p>One of the following role based access control groups are required to create the app registration:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Application Administrator
Cloud Application Administrator
Global Administrator 
</code></pre></div></div>

<p>Register the Application for Microsoft Graph.</p>

<ol>
  <li>
    <p>Navigate to <code class="language-plaintext highlighter-rouge">Azure Portal &gt; Active Directory &gt; App Registration &gt; New Registration</code></p>

    <p><img src="/assets/images/abac/app-registration.png" alt="Register an application" /></p>
  </li>
  <li>
    <p>Provide the following details for the Application registration:</p>

    <ul>
      <li>Name: <code class="language-plaintext highlighter-rouge">Agency to define</code></li>
      <li>Who can use this application or access this API: <code class="language-plaintext highlighter-rouge">Accounts in this organizational directory only</code></li>
      <li>Redirect URI: Web | <code class="language-plaintext highlighter-rouge">http://localhost</code></li>
    </ul>
  </li>
  <li>
    <p>Navigate to <code class="language-plaintext highlighter-rouge">Azure Portal &gt; Active Directory &gt; App registrations &gt; Application Name &gt; API permissions</code></p>

    <p><img src="/assets/images/abac/app-registration-api.png" alt="API permissions" /></p>
  </li>
  <li>
    <p>Add the following permissions to the application</p>

    <ul>
      <li>API Permissions name: <code class="language-plaintext highlighter-rouge">Microsoft Graph</code>
        <ul>
          <li>Type: <code class="language-plaintext highlighter-rouge">Application Permissions</code></li>
          <li>Permission:<code class="language-plaintext highlighter-rouge">AuditLog.Read.All</code></li>
          <li>Permission: <code class="language-plaintext highlighter-rouge">Directory.Read.All</code></li>
          <li>Permission:<code class="language-plaintext highlighter-rouge">User.Read.All</code></li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>Click on the <code class="language-plaintext highlighter-rouge">Grant admin consent</code>  button to complete the registration.</p>
  </li>
  <li>
    <p>Navigate to <code class="language-plaintext highlighter-rouge">Azure Portal &gt; Active Directory &gt; App registrations &gt; Application Name &gt; Certificates and secrets</code></p>

    <p><img src="/assets/images/abac/app-registration-secret.png" alt="Certificates and secrets" /></p>
  </li>
  <li>
    <p>Generate a client secret and take note of the details (client ID and secret) for use in the script below. The client secret is to be stored securely as it can be used to query the environment. The script example uses a client secret for Graph API, for additional security it is recommended to generate certificates.</p>
  </li>
</ol>

<h2 id="sample-automation-script">Sample automation script</h2>

<p>The following is a sample script that is used to query Microsoft Graph API for user sign-in information:</p>

<ul>
  <li>Users that have not signed in within 30 days are disabled,</li>
  <li>Emergency administrative accounts (break glass) are exempt, and</li>
  <li>Accounts that have not yet logged on are excluded.</li>
</ul>

<p>The script is ideally executed within an Azure Automation account on a schedule. The permissions delegated to the script to disable user accounts would be granted to the Azure Automation RunAs account within the tenant.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Sample Script - disable user accounts in tenant that have not been logged in within 30 days</span><span class="w">
</span><span class="c"># Source: https://desktop.gov.au/blueprint/abac/admin-disable-inactive-users.html</span><span class="w">

</span><span class="c"># Connection information for Azure AD using Azure Automation account/runbook</span><span class="w">
</span><span class="nv">$connectionName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AzureRunAsConnection</span><span class="w">
</span><span class="nv">$servicePrincipalConnection</span><span class="o">=</span><span class="n">Get-AutomationConnection</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="nv">$connectionName</span><span class="w">         
</span><span class="n">Connect-AzureAD</span><span class="w"> </span><span class="nt">-TenantId</span><span class="w"> </span><span class="nv">$servicePrincipalConnection</span><span class="o">.</span><span class="nf">TenantId</span><span class="w"> </span><span class="se">`
</span><span class="w">     </span><span class="nt">-ApplicationId</span><span class="w"> </span><span class="nv">$servicePrincipalConnection</span><span class="o">.</span><span class="nf">ApplicationId</span><span class="w"> </span><span class="se">`
</span><span class="w">     </span><span class="nt">-CertificateThumbprint</span><span class="w"> </span><span class="nv">$servicePrincipalConnection</span><span class="o">.</span><span class="nf">CertificateThumbprint</span><span class="w">
 
</span><span class="c"># Manual connect to Azure AD</span><span class="w">
</span><span class="c">#Connect-AzureAD   </span><span class="w">
 
</span><span class="c"># Connection information for Graph API connection - specific to Agency</span><span class="w">
</span><span class="nv">$clientID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"</span><span class="w">
</span><span class="nv">$tenantName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"agency.onmicrosoft.com"</span><span class="w">
</span><span class="nv">$clientSecret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span><span class="w">
</span><span class="nv">$resource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://graph.microsoft.com/"</span><span class="w">
 
</span><span class="nv">$ReqTokenBody</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
    </span><span class="nx">Grant_Type</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"client_credentials"</span><span class="w">
    </span><span class="nx">Scope</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://graph.microsoft.com/.default"</span><span class="w">
    </span><span class="nx">client_Id</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">$clientID</span><span class="w">
    </span><span class="nx">Client_Secret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$clientSecret</span><span class="w">
</span><span class="p">}</span><span class="w"> 
 
</span><span class="nv">$TokenResponse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="s2">"https://login.microsoftonline.com/</span><span class="nv">$TenantName</span><span class="s2">/oauth2/v2.0/token"</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">POST</span><span class="w"> </span><span class="nt">-Body</span><span class="w"> </span><span class="nv">$ReqTokenBody</span><span class="w">
 
</span><span class="c"># Get all users in the tenant</span><span class="w">
</span><span class="nv">$uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'https://graph.microsoft.com/beta/users?$select=displayName,userPrincipalName,signInActivity'</span><span class="w">
 
</span><span class="c"># Get todays date for date test later</span><span class="w">
</span><span class="nv">$Today</span><span class="o">=</span><span class="p">(</span><span class="n">Get-Date</span><span class="p">)</span><span class="w">

</span><span class="c"># @odata.nextLink is used if results greated than 999 results</span><span class="w">
</span><span class="nv">$Data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">while</span><span class="w"> </span><span class="p">(</span><span class="o">-not</span><span class="w"> </span><span class="p">[</span><span class="n">string</span><span class="p">]::</span><span class="n">IsNullOrEmpty</span><span class="p">(</span><span class="nv">$uri</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nv">$apiCall</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="p">@{</span><span class="nx">Authorization</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Bearer </span><span class="si">$(</span><span class="nv">$Tokenresponse</span><span class="o">.</span><span class="nf">access_token</span><span class="si">)</span><span class="s2">"</span><span class="p">}</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">Get</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="kr">catch</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nv">$errorMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$_</span><span class="o">.</span><span class="nf">ErrorDetails</span><span class="o">.</span><span class="nf">Message</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ConvertFrom-Json</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="nv">$uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">$null</span><span class="w">
    </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$apiCall</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nv">$uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$apiCall</span><span class="o">.</span><span class="s1">'@odata.nextLink'</span><span class="w">
        </span><span class="nv">$apiCall</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
 
</span><span class="c"># Set the result into an variable</span><span class="w">
</span><span class="nv">$result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nv">$Data</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">select-object</span><span class="w"> </span><span class="nx">Value</span><span class="p">)</span><span class="o">.</span><span class="nf">Value</span><span class="w">
</span><span class="nv">$Export</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$result</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="nx">DisplayName</span><span class="p">,</span><span class="nx">UserPrincipalName</span><span class="p">,@{</span><span class="nx">n</span><span class="o">=</span><span class="s2">"LastLoginDate"</span><span class="p">;</span><span class="nx">e</span><span class="o">=</span><span class="p">{</span><span class="bp">$_</span><span class="o">.</span><span class="nf">signInActivity</span><span class="o">.</span><span class="nf">lastSignInDateTime</span><span class="p">}}</span><span class="w">

</span><span class="c"># Export user data</span><span class="w">
</span><span class="nv">$Users</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$Export</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="nx">DisplayName</span><span class="p">,</span><span class="nx">UserPrincipalName</span><span class="p">,@{</span><span class="nx">Name</span><span class="o">=</span><span class="s1">'LastLoginDate'</span><span class="p">;</span><span class="nx">Expression</span><span class="o">=</span><span class="p">{[</span><span class="n">datetime</span><span class="p">]::</span><span class="n">Parse</span><span class="p">(</span><span class="bp">$_</span><span class="o">.</span><span class="nf">LastLoginDate</span><span class="p">)}}</span><span class="w">

</span><span class="c">#Disable accounts that are not breakglass that have not been used in 30 days.</span><span class="w">
</span><span class="kr">Foreach</span><span class="w"> </span><span class="p">(</span><span class="nv">$User</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$Users</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$User</span><span class="o">.</span><span class="nf">LastLoginDate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">        
        </span><span class="nv">$LastLogin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$User</span><span class="o">.</span><span class="nf">LastLoginDate</span><span class="w">
        </span><span class="nv">$TimeSpan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">New-TimeSpan</span><span class="w"> </span><span class="err">–</span><span class="nx">Start</span><span class="w"> </span><span class="nv">$LastLogin</span><span class="w"> </span><span class="err">–</span><span class="nx">End</span><span class="w"> </span><span class="nv">$Today</span><span class="w">
        </span><span class="kr">If</span><span class="w"> </span><span class="p">(</span><span class="nv">$TimeSpan</span><span class="o">.</span><span class="nf">Days</span><span class="w"> </span><span class="o">-gt</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">write-host</span><span class="w"> </span><span class="s2">"User to be disabled true"</span><span class="w"> </span><span class="nv">$User</span><span class="o">.</span><span class="nf">userPrincipalName</span><span class="w"> </span><span class="s2">"Last logon:"</span><span class="nv">$user</span><span class="o">.</span><span class="nf">LastLoginDate</span><span class="w"> </span><span class="nv">$TimeSpan</span><span class="o">.</span><span class="nf">Days</span><span class="w"> </span><span class="s2">"days ago"</span><span class="w">
            </span><span class="kr">If</span><span class="w"> </span><span class="p">(</span><span class="nv">$User</span><span class="o">.</span><span class="nf">userPrincipalName</span><span class="w"> </span><span class="o">-notlike</span><span class="w"> </span><span class="s1">'*break.glass*'</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="n">write-host</span><span class="w"> </span><span class="nv">$User</span><span class="o">.</span><span class="nf">userPrincipalName</span><span class="w"> </span><span class="s2">"-User not breakglass account, proceed with disable of user"</span><span class="w">
                </span><span class="n">Set-AzureADUser</span><span class="w"> </span><span class="nt">-ObjectId</span><span class="w"> </span><span class="nv">$User</span><span class="o">.</span><span class="nf">userPrincipalName</span><span class="w"> </span><span class="nt">-AccountEnabled</span><span class="w"> </span><span class="bp">$false</span><span class="w">
                </span><span class="n">Revoke-AzureADUserAllRefreshToken</span><span class="w"> </span><span class="nt">-ObjectId</span><span class="w"> </span><span class="nv">$User</span><span class="o">.</span><span class="nf">userPrincipalName</span><span class="w">
            </span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="n">write-host</span><span class="w"> </span><span class="nv">$User</span><span class="o">.</span><span class="nf">userPrincipalName</span><span class="w"> </span><span class="s2">"- User is breakglass account, no action taken on user"</span><span class="w">
            </span><span class="p">}</span><span class="w">               
        </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="n">write-host</span><span class="w"> </span><span class="nv">$User</span><span class="o">.</span><span class="nf">userPrincipalName</span><span class="w"> </span><span class="s2">"-User is active within 30 day threshold, last logon:"</span><span class="nv">$user</span><span class="o">.</span><span class="nf">LastLoginDate</span><span class="w"> </span><span class="s2">" "</span><span class="w"> </span><span class="nv">$TimeSpan</span><span class="o">.</span><span class="nf">Days</span><span class="w"> </span><span class="s2">" days ago"</span><span class="w">
        </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>


                        
                    </div>
                </div>
            </div>
        </div>
    </section>
</main>


<section class="feedback au-body text-centered">
    <p>Portal Technology - End Section</p>
</section>

<footer class="au-footer au-footer--dark au-body au-body--dark hidden-print" role="contentinfo">
    <div id="back-to-top" class="transition-medium hidden-print">
        <a href="#top">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-double-up" viewBox="0 0 16 16">
                <path fill-rule="evenodd" d="M7.646 2.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 3.707 2.354 9.354a.5.5 0 1 1-.708-.708l6-6z"/>
                <path fill-rule="evenodd" d="M7.646 6.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 7.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"/>
            </svg>
            <br>
            Back to Top
        </a>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-sm-2 text-centered" id="dta-initiative">
                <a href="https://www.dta.gov.au/"><img src="/assets/images/dta-wordmark-white.png" alt="An initiative of the Digital Transformation Agency"></a>
            </div>
            <div class="col-sm-10">
                <nav aria-label="footer">
                    <!-- <ul class="au-link-list au-link-list--inline">
                        <li><a href="mailto:protectedutility@dta.gov.au">Contact us</a></li>
                        <li><a href="https://www.dta.gov.au/our-privacy-policy">Privacy</a></li>
                        <li><a href="https://www.dta.gov.au/disclaimer-and-copyright">Disclaimer</a></li>
                        <li><a href="https://www.dta.gov.au/accessibility">Accessibility</a></li>
                    </ul> -->
                </nav>
                <div class="au-footer__end">
                    <p>This page has been built by Portal Technology based on work provided by the Australian Government.<br> </p>
                    <p>&copy; Commonwealth of Australia. With the exception of the Commonwealth Coat of Arms and where otherwise noted, this work is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> license.</p>
                </div>
            </div>
        </div>
    </div>
</footer>
<script src="/assets/js/jquery-3.5.1.slim.min.js"></script>
<script src="/assets/js/designsystem.min.js"></script>
<script src="/assets/js/bootstrap.min.js"></script>
<script src="/assets/js/jquery.tablesorter.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.5.1/dist/algoliasearch-lite.umd.js" integrity="sha256-EXPXz4W6pQgfYY3yTpnDa3OH8/EPn16ciVsPQ/ypsjk=" crossorigin="anonymous"></script>
<script>const search_client = algoliasearch('', ''); const search_index = search_client.initIndex('');</script>
<script src="/assets/js/scripts.js"></script>
</body>
</html>